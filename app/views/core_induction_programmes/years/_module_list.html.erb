<% if course_modules.each do |course_module| %>
  <ul class="app-task-list__items">
    <li>
      <div class="app-task-list__item">
        <h3 class="govuk-heading-m">
          <%= govuk_link_to(course_module.title, module_path(course_module)) %>
        </h3>

        <div class="gem-c-govspeak govuk-govspeak">
          <% if current_user.admin? %>
            <h4 class="govuk-heading-s">Mentor summary</h4>
            <%= course_module.mentor_summary_to_html.html_safe.presence || "<p>No mentor summary</p>".html_safe %>
            <h4 class="govuk-heading-s">ECT summary</h4>
            <%= course_module.ect_summary_to_html.html_safe.presence || "<p>No ECT summary</p>".html_safe%>
          <% elsif current_user.mentor? %>
            <%= course_module.mentor_summary_to_html.html_safe.presence || "<p>No mentor summary</p>".html_safe%>
          <% else %>
            <%= course_module.ect_summary_to_html.html_safe.presence || "<p>No ECT summary</p>".html_safe%>
          <% end %>
        </div>

        <% if current_user.early_career_teacher? %>
          <div class="app-task-list__section">
            <span><%= course_module.self_study_lessons.count.humanize.capitalize %> self-study <%= "session".pluralize(course_module.course_lessons.count) %></span>

            <%= render ProgressLabelComponent.new progress: course_module.progress %>
          </div>
        <% end %>
      </div>
    </li>
  </ul>
<% end.empty? %>
  <p>No course modules were found!</p>
<% end %>
